/* Projeto Lab LITTORAL: Envio de um sinal IR e Acionamento Online */

#define  BLYNK_PRINT Serial
#include  <ESP8266WiFi.h>
#include  <BlynkSimpleEsp8266.h>
int pinValue;
#include <IRac.h>
#include <IRrecv.h>
#include <IRremoteESP8266.h>
#include <IRsend.h>

char auth [] = " K5qD_hOOgwgsG_wkFKM47SzGTdBtSZh9 " ; // Meu Token do BLYNK
char ssid [] = " ..... " ;
char pass [] = " wifidecasa " ;

const uint16_t IrLed = 4;
IRsend irsend(IrLed);

uint16_t powerOffRawData[199] = {4368, 4358,  512, 1658,  514, 576,  514, 1656,  516, 1658,  512, 576,  514, 576,  514, 1658,  514, 578,  538, 548,  514, 1662,  510, 576,  514, 576,  512, 1660,  514, 1656,  514, 574,  514, 1662,  538, 550,  512, 1658,  512, 1658,  514, 1658,  514, 1658,  514, 576,  514, 1658,  514, 1662,  536, 1634,  510, 576,  514, 576,  514, 576,  514, 576,  514, 1656,  514, 576,  514, 578,  538, 1632,  512, 1660,  514, 1660,  512, 576,  514, 576,  512, 576,  514, 576,  514, 578,  538, 550,  514, 574,  514, 576,  514, 1660,  512, 1662,  512, 1658,  514, 1658,  514, 1656,  540, 5192,  4370, 4352,  512, 1658,  512, 576,  512, 1660,  512, 1658,  512, 576,  512, 576,  512, 1658,  514, 578,  538, 550,  514, 1660,  512, 576,  514, 576,  514, 1656,  514, 1660,  512, 576,  514, 1660,  536, 550,  512, 1660,  512, 1658,  512, 1658,  514, 1660,  512, 574,  514, 1660,  510, 1664,  536, 1632,  512, 576,  514, 576,  514, 576,  512, 576,  514, 1684,  488, 576,  514, 578,  538, 1634,  512, 1656,  514, 1658,  512, 576,  514, 576,  514, 576,  512, 576,  512, 578,  538, 550,  512, 576,  514, 576,  512, 1658,  514, 1660,  510, 1660,  510, 1682,  488, 1662,  538};  // COOLIX B27BE0
uint16_t powerOnRawData[199] = {4368, 4358,  512, 1658,  514, 576,  514, 1656,  516, 1658,  512, 576,  514, 576,  514, 1658,  514, 578,  538, 548,  514, 1662,  510, 576,  514, 576,  512, 1660,  514, 1656,  514, 574,  514, 1662,  538, 550,  512, 1658,  512, 1658,  514, 1658,  514, 1658,  514, 576,  514, 1658,  514, 1662,  536, 1634,  510, 576,  514, 576,  514, 576,  514, 576,  514, 1656,  514, 576,  514, 578,  538, 1632,  512, 1660,  514, 1660,  512, 576,  514, 576,  512, 576,  514, 576,  514, 578,  538, 550,  514, 574,  514, 576,  514, 1660,  512, 1662,  512, 1658,  514, 1658,  514, 1656,  540, 5192,  4370, 4352,  512, 1658,  512, 576,  512, 1660,  512, 1658,  512, 576,  512, 576,  512, 1658,  514, 578,  538, 550,  514, 1660,  512, 576,  514, 576,  514, 1656,  514, 1660,  512, 576,  514, 1660,  536, 550,  512, 1660,  512, 1658,  512, 1658,  514, 1660,  512, 574,  514, 1660,  510, 1664,  536, 1632,  512, 576,  514, 576,  514, 576,  512, 576,  514, 1684,  488, 576,  514, 578,  538, 1634,  512, 1656,  514, 1658,  512, 576,  514, 576,  514, 576,  512, 576,  512, 578,  538, 550,  512, 576,  514, 576,  512, 1658,  514, 1660,  510, 1660,  510, 1682,  488, 1662,  538};  // COOLIX B27BE0
WidgetLCD lcd(V0);
BLYNK_WRITE (V1)
{
pinValue = param. asInt ();
     if (pinValue == 1 ) {
      
// this works
lcd.print(0,0,"Enviando sinal...");
  irsend.sendRaw(powerOffRawData, 199, 38);
  delay(5000);
// this doesn't work
  irsend.sendCOOLIX(0xB27BE0);
  delay(500);
        
    }
}
BLYNK_WRITE (V2)
{
pinValue = param. asInt ();
     if (pinValue == 1 ) {

  lcd.print(0,0,"Enviando sinal...");
  irsend.sendRaw(powerOnRawData, 199, 38);
  delay(5000);
// this doesn't work
  irsend.sendCOOLIX(0xB27BE0);
  delay(500);
        
    }
}

void  setup () {
  
  irsend.begin();
  Serial.begin(115200, SERIAL_8N1, SERIAL_TX_ONLY);
  Blynk.begin (auth, ssid, pass);
  
}

void  loop () {
  Blynk.run ();
}
